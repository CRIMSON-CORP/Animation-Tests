<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      *,
      html,
      body {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
      }

      body {
        background-color: rgb(48, 48, 48);
        padding: 20px;
        display: grid;
        height: 100vh;
        height: 100svh;
        color: #444;
        overflow: auto;
      }

      #app {
        background: url("/email-app-bg.jpg") center/cover no-repeat;
        box-shadow: 0px 0px 20px 0px rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        overflow: auto;
      }

      .container {
        width: 100%;
        height: 100%;
        max-width: 900px;
        max-height: 90vh;
        display: grid;
        grid-template-columns: 64px 0.3fr 0.7fr;
        overflow: visible;
        position: relative;

        /* & > .loader-container {
          opacity: 0;
        } */
        & > :not(.loader-container) {
          opacity: 0;
        }

        .loader-container {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          max-width: 400px;
          width: 100%;
          height: 100%;
          max-height: 150px;
          .loader {
            width: 100%;
            height: 100%;
            background-color: rgba(230, 236, 245, 0.7);
            backdrop-filter: blur(6px);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;

            .box-container {
              display: grid;
              gap: 2px;
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 2px;

              .box {
                width: 10px;
                height: 10px;
                background-color: #333;
                transform: translateX(-50vw);
              }
            }
          }

          .title-display {
            opacity: 0;
          }
        }

        .unread-preview {
          max-width: 400px;
          max-height: 65vh;
          .title-display {
            position: absolute;
            top: 50%;
            left: 70%;
            transform: translate(-50%, -50%);
          }
        }
      }

      .menu-bar {
        background-color: rgba(230, 236, 245, 0.4);
        backdrop-filter: blur(6px);
        overflow: auto;
        display: grid;
        grid-template-columns: subgrid;
        grid-template-rows: subgrid;
        position: relative;
        grid-column: 1 / span 3;
        grid-row: 1 / span 1;
        transform-origin: right;

        .content-wrapper {
          padding: 16px;
          display: flex;
          flex-direction: column;
          gap: 32px;
          grid-column: 1 / span 1;
          grid-row: 1 / span 1;
          align-items: center;
        }

        ul {
          display: flex;
          flex-direction: column;
          gap: 18px;
          align-items: center;
        }

        & > svg:last-child {
          margin-top: auto;
        }
      }

      .recents {
        background-color: rgb(243, 243, 243);
        overflow: auto;
        position: relative;
        display: grid;
        grid-template-columns: subgrid;
        grid-template-rows: subgrid;
        grid-column: 2 / span 2;
        grid-row: 1 / span 1;
        transform-origin: right;
        box-shadow: 0px 0px 40px rgba(0, 0, 0, 0.1);

        .content-wrapper {
          display: flex;
          flex-direction: column;
          grid-column: 1 / span 1;
          grid-row: 1 / span 1;
          & > header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background-color: rgb(235, 180, 61);

            .data {
              display: flex;
              flex-direction: column;
              gap: 4px;

              .inbox-wrapper {
                display: flex;
                align-items: center;
                gap: 4px;
                font-size: 14px;
              }

              & > p {
                font-size: 16px;
                font-weight: 600;
              }
            }

            & > img {
              border-radius: 50%;
            }
          }

          .list-groups {
            display: flex;
            flex-direction: column;
            overflow: auto;
            height: 100%;

            & > p {
              text-transform: uppercase;
              padding: 12px;
              font-size: 12px;
              color: rgba(235, 180, 61, 0.884);
            }

            ul {
              display: flex;
              flex-direction: column;
              gap: 16px;
              overflow: auto;
              height: 100%;

              li {
                display: flex;
                flex-direction: column;
                padding: 0px 12px;
                position: relative;

                header {
                  display: flex;
                  align-items: center;
                  justify-content: space-between;

                  .name {
                    font-size: 14px;
                    font-weight: 600;
                  }

                  .time {
                    font-size: 12px;
                    font-weight: 600;
                    text-transform: uppercase;
                  }
                }

                & > p {
                  font-size: 12px;
                  -webkit-box-orient: vertical;
                  display: -webkit-box;
                  line-clamp: 1;
                  -webkit-line-clamp: 1;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  opacity: 0.5;
                }
                &.unread::before {
                  content: "";
                  position: absolute;
                  width: 3px;
                  height: 100%;
                  top: 0px;
                  bottom: 0px;
                  left: 0px;
                  background-color: rgba(235, 180, 61, 0.884);
                }
              }
            }
          }
        }
      }

      .mail-preview {
        position: relative;
        background-color: white;
        grid-column: 3 / span 1;
        grid-row: 1 / span 1;
        display: grid;
        grid-template-columns: subgrid;
        grid-template-rows: subgrid;
        box-shadow: 0px 0px 50px rgba(0, 0, 0, 0.1);
        transform-origin: left;
        .content-wrapepr {
          display: grid;
          grid-column: 2 / span 1;
          grid-row: 2 / span 1;
          & > svg {
            position: absolute;
            top: 30%;
            left: 50%;
            white-space: nowrap;
            transform: translate(-50%, -50%);
          }
        }
      }
      .title-display {
        font-size: 64px;
        position: absolute;
        top: 50%;
        left: 50%;
        white-space: nowrap;
        transform: translate(-50%, -50%);
        z-index: 10;
        overflow: hidden;
        padding: 0px 0px;

        &::before {
          content: "";
          position: absolute;
          bottom: 0px;
          left: 0;
          transform: translateX(-100%);
          transition: transform 1s cubic-bezier(0.42, 0.04, 0, 0.99) 0.5s;
          background-color: coral;
          width: 30px;
          height: 3px;
        }
        &.active::before {
          transform: translateX(0%);
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="container">
        <div class="loader-container">
          <div class="loader">
            <div class="box-container">
              <div class="box"></div>
              <div class="box"></div>
              <div class="box"></div>
              <div class="box"></div>
            </div>
          </div>
        </div>
        <div class="menu-bar">
          <div class="content-wrapper">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M3 7h18M3 12h18M3 17h18"
                stroke="#000000"
                stroke-width="1.5"
                stroke-linecap="round"
              ></path>
            </svg>
            <ul>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M6 12h12M12 18V6"
                  stroke="#000000"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></path>
              </svg>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10ZM20.59 22c0-3.87-3.85-7-8.59-7s-8.59 3.13-8.59 7"
                  stroke="#000000"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></path>
              </svg>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M11.5 21a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19ZM22 22l-2-2"
                  stroke="#000000"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></path>
              </svg>
            </ul>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                stroke="#000000"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M9.11 5.08c.87-.26 1.83-.43 2.89-.43 4.79 0 8.67 3.88 8.67 8.67s-3.88 8.67-8.67 8.67-8.67-3.88-8.67-8.67c0-1.78.54-3.44 1.46-4.82M7.87 5.32L10.76 2M7.87 5.32l3.37 2.46"
              ></path>
            </svg>
          </div>
        </div>
        <div class="recents">
          <div class="content-wrapper">
            <header>
              <div class="data">
                <div class="inbox-wrapper">
                  <p>Inbox</p>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="12"
                    height="12"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      stroke="#000000"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-miterlimit="10"
                      stroke-width="1.5"
                      d="M19.92 8.95l-6.52 6.52c-.77.77-2.03.77-2.8 0L4.08 8.95"
                    ></path>
                  </svg>
                </div>
                <p>7 new emails</p>
              </div>
              <img src="/email-app-bg.jpg" width="42" height="42" alt="" />
            </header>
            <div class="list-groups">
              <p>today</p>
              <ul>
                <li class="unread">
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
                <li>
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
                <li class="unread">
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
                <li class="unread">
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
                <li>
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
                <li class="unread">
                  <header>
                    <p class="name">Derek Arkins</p>
                    <p class="time">6:44 am</p>
                  </header>
                  <p class="subject">Re: Photo Shoot</p>
                  <p class="exerpt">
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Hic, quidem.
                  </p>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="mail-preview">
          <div class="content-wrapepr">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="#333"
            >
              <path
                d="M17 20.5H7c-3 0-5-1.5-5-5v-7c0-3.5 2-5 5-5h10c3 0 5 1.5 5 5v7c0 3.5-2 5-5 5Z"
                stroke="#333"
                stroke-width="1.5"
                stroke-miterlimit="10"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></path>
              <path
                d="m17 9-3.13 2.5c-1.03.82-2.72.82-3.75 0L7 9"
                stroke="#fff"
                stroke-width="1.5"
                stroke-miterlimit="10"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></path>
            </svg>
            <div class="title-display">7 new emails</div>
          </div>
        </div>
        <div class="title-display">7 new emails</div>
      </div>
    </div>
    <script>
      const container = document.querySelector(".container");
      const loadingContainer = document.querySelector(".loader-container");
      const boxContainer = document.querySelector(".box-container");
      const boxList = [...boxContainer.children];

      //   const linearEase =
      //     "linear(0.00, -0.0269, 0.00969, 0.109, 0.243, 0.386, 0.523, 0.647, 0.752, 0.837, 0.902, 0.951, 0.985, 1.01, 1.02, 1.03, 1.03, 1.03, 1.02, 1.02, 1.02, 1.01, 1.01, 1.01, 1.00, 1.00, 1.00, 1.00, 1.00)";

      const linearEase = "cubic-bezier(.42,.04,0,.99)";

      const enteranceOrder = [boxList[1], boxList[0], boxList[3], boxList[2]];
      const exitOrder = [boxList[3], boxList[2], boxList[1], boxList[0]];

      let loadingIterationCount = 0;
      const runLoadingAnimation = async () => {
        if (loadingIterationCount === 1) {
          return;
        }
        await Promise.all(
          enteranceOrder.map((box, index) => {
            return box.animate(
              {
                transform: ["translateX(-50vw)", "translateX(0vw)"],
              },
              {
                delay: index * 250,
                duration: 1000,
                fill: "forwards",
                easing: "cubic-bezier(0,.51,.14,1)",
              }
            ).finished;
          })
        );
        await Promise.all(
          exitOrder.map((box, index, boxes) => {
            return box.animate(
              {
                transform: ["translateX(0vw)", "translateX(50vw)"],
              },
              {
                delay: index * 250,
                duration: 1000,
                fill: "forwards",
                easing: "cubic-bezier(1,.01,1,.28)",
              }
            ).finished;
          })
        );
        loadingIterationCount++;
        runLoadingAnimation();
      };

      setTimeout(() => {
        showPreview();
      }, 3000);
      window.addEventListener("load", () => {
        runLoadingAnimation();
      });

      async function showPreview() {
        const loaderInitialRect = loadingContainer.getBoundingClientRect();
        loadingContainer.classList.add("unread-preview");
        const finalRect = loadingContainer.getBoundingClientRect();

        const loadinContainerAnim = loadingContainer.animate(
          {
            width: [loaderInitialRect.width + "px", finalRect.width + "px"],
            height: [loaderInitialRect.height + "px", finalRect.height + "px"],
          },
          {
            duration: 1200,
            fill: "forwards",
            easing: "cubic-bezier(.24,.1,0,.99)",
          }
        );

        const loadingContainerBackgroundAnim =
          loadingContainer.children[0].animate(
            {
              backgroundColor: "rgb(243, 243, 243)",
            },
            {
              duration: 1000,
              fill: "forwards",
              easing: linearEase,
            }
          );
        const titleTextAnima = container.children[4].animate(
          {
            opacity: ["0", "1"],
            transform: [
              "translateX(-50%) translateY(-50%)",
              "translateX(-20%) translateY(-50%)",
            ],
          },
          {
            delay: 300,
            duration: 1000,
            fill: "forwards",
            easing: linearEase,
          }
        );

        await Promise.all([
          loadinContainerAnim.finished,
          loadingContainerBackgroundAnim.finished,
          titleTextAnima.finished,
        ]);

        showMail();
      }

      const menuBar = document.querySelector(".menu-bar");
      const recents = document.querySelector(".recents");
      const mailPreview = document.querySelector(".mail-preview");

      function showMail() {
        const loadingContainerRect = loadingContainer.getBoundingClientRect();
        const menuBarRect = menuBar.getBoundingClientRect();
        const recentsRect = recents.getBoundingClientRect();
        const mailPreviewRect = recents.getBoundingClientRect();

        const loadingTitleText = container.children[4];
        const mailPreviewTitleText = mailPreview.firstElementChild.children[1];

        const loadingTitleTextRect = loadingTitleText.getBoundingClientRect();
        const mailPreviewTitleTextRect =
          mailPreviewTitleText.getBoundingClientRect();
        mailPreviewTitleText.remove();

        loadingTitleText.classList.add("active");
        loadingTitleText.animate(
          {
            transform: [
              "translateX(-20%) translateY(-50%)",
              `translate(calc(-20% + ${
                mailPreviewTitleTextRect.left - loadingTitleTextRect.left
              }px), -50%)`,
            ],
          },
          {
            delay: 400,
            duration: 1200,
            fill: "forwards",
            easing: linearEase,
          }
        );

        loadingContainer.animate(
          {
            opacity: ["1", "0"],
          },
          {
            delay: 500,
            duration: 1000,
            fill: "forwards",
            easing: linearEase,
          }
        );

        menuBar.animate(
          {
            opacity: ["0", "1"],
            transform: [
              `translateX(${
                loadingContainerRect.left - menuBarRect.left
              }px) scaleX(${
                loadingContainerRect.width / menuBarRect.width
              }) scaleY(${loadingContainerRect.height / menuBarRect.height})`,
              `translateX(0px) scaleX(1) scaleY(1)`,
            ],
            transformOrigin: [
              `${
                loadingContainerRect.left +
                loadingContainerRect.width / 2 -
                (menuBarRect.left + menuBarRect.width / 2)
              }px`,
              `${
                loadingContainerRect.left +
                loadingContainerRect.width / 2 -
                (menuBarRect.left + menuBarRect.width / 2)
              }px`,
            ],
          },
          {
            delay: 200,
            duration: 1000,
            fill: "forwards",
            easing: linearEase,
          }
        );

        recents.style.opacity = "1";
        const animatableChildren = recents.querySelectorAll("header, p, img");

        animatableChildren.forEach((child, index) => {
          child.style.opacity = "0";
          child.animate(
            {
              opacity: ["0", "1"],
              transform: ["translateY(-20%)", "translateY(0%)"],
            },
            {
              fill: "forwards",
              duration: 600,
              easing: "ease-out",
              delay: 1000 + index * 20,
            }
          );
        });

        recents.animate(
          {
            transform: [
              `translateX(${
                loadingContainerRect.left - recentsRect.left
              }px) scaleX(${
                loadingContainerRect.width / recentsRect.width
              }) scaleY(${loadingContainerRect.height / recentsRect.height})`,
              `translateX(0px) scaleX(1) scaleY(1)`,
            ],
            transformOrigin: [`${0}px`, `${0}px`],
          },
          {
            duration: 1000,
            fill: "forwards",
            easing: linearEase,
          }
        );

        mailPreview.animate(
          {
            opacity: ["0", "1"],
          },
          {
            delay: 400,
            duration: 400,
            fill: "forwards",
            easing: linearEase,
          }
        );
        mailPreview.animate(
          {
            opacity: ["0", "1"],
            transform: [
              `translateX(-10%) scaleX(0.9) scaleY(0.9)`,
              `translateX(0px) scaleX(1) scaleY(1)`,
            ],
          },
          {
            delay: 400,
            duration: 1200,
            fill: "forwards",
            easing: linearEase,
          }
        );
      }
    </script>
  </body>
</html>
